-- Schema for Profile
-- Generated by CIMTool http://cimtool.org

-- Defines a system base voltage which is referenced.
CREATE TABLE "BaseVoltage"
(
    "mRID" CHAR VARYING(30) NOT NULL UNIQUE
);

-- The parts of the power system that are designed to carry current or that
-- are conductively connected through terminals.
CREATE TABLE "ConductingEquipment"
(
    "mRID" CHAR VARYING(30) NOT NULL UNIQUE,
    -- Base voltage of this conducting equipment. Use only when there is no voltage
    -- level container used and only one base voltage applies. For example, not
    -- used for transformers.
    "BaseVoltage"CHAR VARYING(30)
);

-- Connectivity nodes are points where terminals of conducting equipment are
-- connected together with zero impedance.
CREATE TABLE "ConnectivityNode"
(
    "mRID" CHAR VARYING(30) NOT NULL UNIQUE
);

-- A base class for all objects that may contain connectivity nodes or topological
-- nodes.
CREATE TABLE "ConnectivityNodeContainer"
(
    "mRID" CHAR VARYING(30) NOT NULL UNIQUE
);

-- The parts of a power system that are physical devices, electronic or mechanical.
CREATE TABLE "Equipment"
(
    "mRID" CHAR VARYING(30) NOT NULL UNIQUE
);

-- This is a root class to provide common identification for all classes needing
-- identification and naming attributes.
CREATE TABLE "IdentifiedObject"
(
    "mRID" CHAR VARYING(30) NOT NULL UNIQUE,
    -- The aliasName is free text human readable name of the object alternative
    -- to IdentifiedObject.name. It may be non unique and may not correlate to
    -- a naming hierarchy.
    -- The attribute aliasName is retained because of backwards compatibility
    -- between CIM relases. It is however recommended to replace aliasName with
    -- the Name class as aliasName is planned for retirement at a future time.
    "aliasName" CHAR VARYING(30),
    -- The name is any free human readable and possibly non unique text naming
    -- the object.
    "name" CHAR VARYING(30)
);

-- A power system resource can be an item of equipment such as a switch, an
-- equipment container containing many individual items of equipment such
-- as a substation, or an organisational entity such as sub-control area.
-- Power system resources can have measurements associated.
CREATE TABLE "PowerSystemResource"
(
    "mRID" CHAR VARYING(30) NOT NULL UNIQUE
);

-- A generic device designed to close, or open, or both, one or more electric
-- circuits.
CREATE TABLE "Switch"
(
    "mRID" CHAR VARYING(30) NOT NULL UNIQUE,
    -- The attribute is used in cases when no Measurement for the status value
    -- is present. If the Switch has a status measurment the Discrete.normalValue
    -- is expected to match with the Switch.normalOpen.
    "normalOpen" CHAR(1),
    -- Branch is retained in a bus branch model.
    "retained" CHAR(1),
    -- The switch on count since the switch was last reset or initialized.
    "switchOnCount" INTEGER,
    -- The date and time when the switch was last switched on.
    "switchOnDate" CHAR VARYING(30),
    -- The maximum continuous current carrying capacity in amps governed by the
    -- device material and construction.
    "ratedCurrent"CHAR VARYING(30)
);

-- An electrical connection point to a piece of conducting equipment. Terminals
-- are connected at physical connection points called connectivity nodes.
CREATE TABLE "Terminal"
(
    "mRID" CHAR VARYING(30) NOT NULL UNIQUE
);

-- For a detailed substation model a topological node is a set of connectivity
-- nodes that, in the current network state, are connected together through
-- any type of closed switches, including jumpers. Topological nodes change
-- as the current network state changes (i.e., switches, breakers, etc. change
-- state).
-- For a planning model, switch statuses are not used to form topological
-- nodes. Instead they are manually created or deleted in a model builder
-- tool. Topological nodes maintained this way are also called "busses".
CREATE TABLE "TopologicalNode"
(
    "mRID" CHAR VARYING(30) NOT NULL UNIQUE
);

-- subclass-superclass constraint
ALTER TABLE "BaseVoltage" ADD FOREIGN KEY ( "mRID" ) REFERENCES "IdentifiedObject" ( "mRID" );
-- subclass-superclass constraint
ALTER TABLE "ConductingEquipment" ADD FOREIGN KEY ( "mRID" ) REFERENCES "Equipment" ( "mRID" );
-- association constraint
ALTER TABLE "ConductingEquipment" ADD FOREIGN KEY ( "BaseVoltage" ) REFERENCES "BaseVoltage" ( "mRID" );
-- subclass-superclass constraint
ALTER TABLE "ConnectivityNode" ADD FOREIGN KEY ( "mRID" ) REFERENCES "IdentifiedObject" ( "mRID" );
-- subclass-superclass constraint
ALTER TABLE "ConnectivityNodeContainer" ADD FOREIGN KEY ( "mRID" ) REFERENCES "PowerSystemResource" ( "mRID" );
-- subclass-superclass constraint
ALTER TABLE "Equipment" ADD FOREIGN KEY ( "mRID" ) REFERENCES "PowerSystemResource" ( "mRID" );
-- subclass-superclass constraint
ALTER TABLE "PowerSystemResource" ADD FOREIGN KEY ( "mRID" ) REFERENCES "IdentifiedObject" ( "mRID" );
-- subclass-superclass constraint
ALTER TABLE "Switch" ADD FOREIGN KEY ( "mRID" ) REFERENCES "ConductingEquipment" ( "mRID" );
-- association constraint
ALTER TABLE "Switch" ADD FOREIGN KEY ( "ratedCurrent" ) REFERENCES "CurrentFlow" ( "mRID" );
-- subclass-superclass constraint
ALTER TABLE "Terminal" ADD FOREIGN KEY ( "mRID" ) REFERENCES "IdentifiedObject" ( "mRID" );
-- subclass-superclass constraint
ALTER TABLE "TopologicalNode" ADD FOREIGN KEY ( "mRID" ) REFERENCES "IdentifiedObject" ( "mRID" );
